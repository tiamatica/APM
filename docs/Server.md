# Server

The server mmodule implements a RESTful HTTP server. It exposes resources that can be accessed and modified if authorised.

## 1. Errors

On error, one of the below HTTP status codes is returned.

| Error Code | Error Type |
| --- | --- |
| 400 Bad Request | Invalid request, e.g. using an unsupported HTTP method |
| 401 Unauthorized | Authentication or authorization error (incorrect API key) |
| 404 Not Found | Requests to resources that don't exist or are missing |
| 500 Internal Server Error | Server error |

## 2. Authentication

Bearer authentication is used when accessing protected resources. API keys can be generated by authenticated users with specific access permissions.

## 3. Packages

The packages API allows listing and adding packages. The result is 

### 3.1. List all packages

`GET /v1/packages`

Available parameters:

| parameter | type | desc |
| --- | --- | --- |
| `per_page` | number | Max number of items returned in result set (default 100). |
| `page` | number | Current page of the collection (default 1). |
| `group` | string | RegEx for package group to match. |
| `name` | string | RegEx for package name to match. |
| `version` | string | RegEx for package version to match. |

### 3.2. Add package

`POST /v1/packages`

To publish a package, simply post the package zip file to the collection. The response is either 201 on a successful operation, or an error code otherwise.

### 3.3. Get package

`GET /v1/packages/<id>`

Request a package by providing the fully qualified name for the package, ie. `group-name-version`. The response is either 200 on a successful operation, or an error code otherwise.

The Content-Type on a successfull operation is `application/zip`.

### 3.4. Dependency tree

`POST /v1/packages/dependencies`

Resolve the dependency tree for the array of packages provided. The tree returned is using the `exact` version strategy.

On successful request, status code 200 is returned together with the resulting tree.

Available parameters:

| parameter | type | desc |
| --- | --- | --- |
| `packages` | array | Array of [package config objects](./apl-project-schema.json) |

| output | type | desc |
| --- | --- | --- |
| `tree` | array | Nested array of [package config objects](./apl-project-schema.json). |
